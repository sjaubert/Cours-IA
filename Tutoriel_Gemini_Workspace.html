<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tutoriel Avancé : Intégration de Gemini CLI avec Google Workspace</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Roboto+Mono:wght@400;700&display=swap');

        body {
            font-family: 'Lato', sans-serif;
            line-height: 1.7;
            color: #333;
            background-color: #f8f9fa;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 20px auto;
            background-color: #ffffff;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
        }

        header {
            text-align: center;
            margin-bottom: 40px;
        }

        header h1 {
            font-size: 2.8em;
            color: #1a73e8;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.2em;
            color: #5f6368;
        }

        h2, h3, h4 {
            color: #202124;
            border-bottom: 2px solid #e8eaed;
            padding-bottom: 10px;
            margin-top: 40px;
        }

        h2 { font-size: 2em; }
        h3 { font-size: 1.6em; }
        h4 { font-size: 1.3em; border-bottom: none; }

        .section {
            margin-bottom: 40px;
        }

        code, pre {
            font-family: 'Roboto Mono', monospace;
            background-color: #e8eaed;
            border-radius: 4px;
        }

        code {
            padding: 3px 6px;
            color: #d93025;
        }

        pre {
            padding: 20px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
            background-color: #202124;
            color: #e8eaed;
            border-radius: 8px;
        }
        
        pre code {
            background-color: transparent;
            padding: 0;
            color: inherit;
        }

        .language-javascript .token.comment { color: #9e9e9e; }
        .language-javascript .token.keyword { color: #669df6; }
        .language-javascript .token.function { color: #fdd835; }
        .language-javascript .token.string { color: #81c995; }

        a {
            color: #1a73e8;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        ol, ul {
            padding-left: 20px;
        }

        li {
            margin-bottom: 15px;
        }

        .note, .warning {
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 5px solid;
        }

        .note {
            background-color: #e8f0fe;
            border-color: #1a73e8;
        }

        .warning {
            background-color: #fef7e0;
            border-color: #f9ab00;
        }
        
        .use-case {
            background-color: #f1f3f4;
            padding: 25px;
            border-radius: 8px;
            margin-top: 20px;
        }

    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>Tutoriel Avancé : Intégration de Gemini CLI avec Google Workspace</h1>
            <p>Automatisez vos workflows et décuplez votre productivité en connectant la puissance de l'IA conversationnelle aux outils Google.</p>
        </header>

        <div class="section" id="introduction">
            <h2>Introduction : Le "Pourquoi"</h2>
            <p>Ce tutoriel s'adresse aux ingénieurs, chefs de projet et cadres souhaitant exploiter Gemini CLI comme un orchestrateur intelligent pour leurs tâches sur Google Workspace. L'objectif est de dépasser la simple conversation avec une IA pour la transformer en un véritable assistant opérationnel.</p>
            <p>En combinant le langage naturel de Gemini avec la puissance de <strong>Google Apps Script (GAS)</strong>, nous pouvons automatiser des processus complexes, manipuler des données et générer des documents à la volée. La technologie clé qui rend cette intégration possible et sécurisée est la bibliothèque <code>gas-fakes</code>, qui exécute les scripts GAS localement en traduisant leurs commandes en appels d'API Google directs.</p>
            <h4>Bénéfices Clés :</h4>
            <ul>
                <li><strong>Productivité Accrue :</strong> Automatisez les tâches répétitives de reporting, de gestion de fichiers ou de saisie de données.</li>
                <li><strong>Rapidité d'Exécution :</strong> Générez des scripts et exécutez des workflows complexes en quelques secondes via une simple instruction en langage naturel.</li>
                <li><strong>Sécurité Renforcée :</strong> Les autorisations sont gérées via le protocole standard OAuth2, garantissant que l'outil n'agit qu'en votre nom et avec votre consentement explicite.</li>
            </ul>
        </div>

        <div class="section" id="configuration">
            <h2>Partie 1 : La Configuration Initiale (À faire une seule fois)</h2>
            <p>Pour permettre à Gemini CLI d'interagir avec vos services Google, nous devons créer une "identité" pour notre application via Google Cloud. C'est cette identité qui demandera votre permission pour accéder à vos données.</p>
            
            <h3>Étape 1.1 : Création du Projet Google Cloud</h3>
            <ol>
                <li>Rendez-vous sur la <a href="https://console.cloud.google.com/" target="_blank">Google Cloud Console</a>.</li>
                <li>Créez un <strong>Nouveau Projet</strong>. Nommez-le de manière explicite, par exemple <code>Gemini-Workspace-Integration</code>.</li>
            </ol>

            <h3>Étape 1.2 : Activation des APIs Essentielles</h3>
            <p>Un projet Google Cloud est une coquille vide. Nous devons y activer les "portes" (APIs) vers les services que nous voulons utiliser.</p>
            <ol>
                <li>Dans votre projet, allez dans la section <strong>APIs et services > Bibliothèque</strong>.</li>
                <li>Recherchez et activez les APIs suivantes (indispensables pour la plupart des cas d'usage) :
                    <ul>
                        <li><code>Google Drive API</code></li>
                        <li><code>Google Sheets API</code></li>
                        <li><code>Google Docs API</code></li>
                        <li><code>Google Slides API</code> (optionnel)</li>
                        <li><code>Gmail API</code> (optionnel, pour les workflows d'emailing)</li>
                    </ul>
                </li>
            </ol>

            <h3>Étape 1.3 : Configuration de l'Écran de Consentement OAuth</h3>
            <p>C'est la page que vous verrez lorsque vous autoriserez l'application pour la première fois. Elle vous informe des permissions demandées.</p>
            <ol>
                <li>Allez dans <strong>APIs et services > Écran de consentement OAuth</strong>.</li>
                <li>Type d'utilisateur : <strong>Externe</strong>.</li>
                <li>Remplissez les informations de base (nom de l'app, email).</li>
                <li>Passez l'étape des "Champs d'application".</li>
                <li>Ajoutez votre propre adresse email comme <strong>Utilisateur test</strong>. C'est crucial pour que vous puissiez autoriser l'application avant qu'elle ne soit officiellement "publiée".</li>
            </ol>

            <h3>Étape 1.4 : Génération des Identifiants</h3>
            <p>Enfin, nous allons générer la clé que notre application utilisera pour s'identifier auprès de Google.</p>
            <ol>
                <li>Allez dans <strong>APIs et services > Identifiants</strong>.</li>
                <li>Cliquez sur <strong>+ CRÉER DES IDENTIFIANTS</strong> et choisissez <strong>ID client OAuth</strong>.</li>
                <li>Type d'application : <strong>Application de bureau</strong>.</li>
                <li>Après la création, cliquez sur l'icône de téléchargement pour obtenir un fichier JSON.</li>
                <li>Renommez ce fichier en <code>credentials.json</code> et placez-le à la racine de votre répertoire de projet (<code>C:\Users\steph\projets\</code>).</li>
            </ol>
            <div class="warning">
                <strong>Sécurité Maximale :</strong> Le fichier <code>credentials.json</code> est une clé secrète. Traitez-le comme un mot de passe. Ne le partagez jamais et ne l'exposez pas sur des dépôts de code publics.
            </div>
        </div>

        <div class="section" id="use-cases">
            <h2>Partie 2 : Cas d'Usage Concrets et Exemples</h2>
            <p>Une fois la configuration terminée, les possibilités sont infinies. Voici des scénarios concrets inspirés par les solutions de la communauté Google Apps Script.</p>

            <div class="use-case">
                <h4>Cas d'Usage 1 : Reporting Automatisé</h4>
                <p><strong>Scénario :</strong> Chaque fin de semaine, vous devez analyser un Google Sheet contenant les ventes, calculer le total et le nombre de transactions, puis ajouter un résumé à un rapport global dans un Google Doc.</p>
                <p><strong>Votre prompt à Gemini CLI :</strong></p>
                <pre><code>"Crée un script qui ouvre le Google Sheet 'Ventes Q4', calcule la somme de la colonne 'Montant' et le nombre de lignes, puis ajoute une nouvelle section au Google Doc 'Rapport Hebdomadaire' avec la date, le montant total des ventes et le nombre de transactions."</code></pre>
                <p><strong>Exemple de script que Gemini pourrait générer et exécuter :</strong></p>
                <pre><code class="language-javascript">// Ce script illustre la logique que Gemini peut générer.

function generateWeeklySalesReport() {
  // 1. Accéder aux fichiers par leur nom
  const sheetFile = DriveApp.getFilesByName('Ventes Q4').next();
  const docFile = DriveApp.getFilesByName('Rapport Hebdomadaire').next();
  
  // 2. Lire et traiter les données du Spreadsheet
  const ss = SpreadsheetApp.openById(sheetFile.getId());
  const sheet = ss.getSheetByName('Feuille 1');
  const range = sheet.getRange('B2:B' + sheet.getLastRow()); // Colonne 'Montant'
  const values = range.getValues();
  
  const totalSales = values.reduce((sum, row) => sum + row[0], 0);
  const transactionCount = values.length;
  
  // 3. Ajouter le résumé au Google Doc
  const doc = DocumentApp.openById(docFile.getId());
  const body = doc.getBody();
  
  const date = new Date().toLocaleDateString('fr-FR');
  
  body.appendParagraph(`Rapport du ${date}`)
      .setHeading(DocumentApp.ParagraphHeading.HEADING2);
  body.appendParagraph(`Chiffre d'affaires total : ${totalSales.toFixed(2)} €`);
  body.appendParagraph(`Nombre de transactions : ${transactionCount}`);
  body.appendHorizontalRule();
  
  console.log('Rapport mis à jour avec succès.');
}
</code></pre>
            </div>

            <div class="use-case">
                <h4>Cas d'Usage 2 : Gestion de Fichiers Intelligente</h4>
                <p><strong>Scénario :</strong> Votre dossier "Projets Clients" dans Google Drive devient désordonné. Vous voulez automatiquement créer une arborescence de dossiers pour un nouveau client à partir d'un modèle.</p>
                <p><strong>Votre prompt à Gemini CLI :</strong></p>
                <pre><code>"Crée un script qui, pour un nouveau nom de client 'Innovatech', crée un dossier principal 'Innovatech' dans mon dossier 'Projets Clients'. À l'intérieur de 'Innovatech', crée les sous-dossiers : '01_Contrats', '02_Facturation', '03_Livrables', '04_Reunions'."</code></pre>
                <p><strong>Exemple de script que Gemini pourrait générer et exécuter :</strong></p>
                <pre><code class="language-javascript">// Ce script illustre la logique que Gemini peut générer.

function createClientFolderStructure(clientName) {
  const parentFolderName = 'Projets Clients';
  const subFolders = ['01_Contrats', '02_Facturation', '03_Livrables', '04_Reunions'];
  
  // 1. Trouver le dossier parent
  const parentFolders = DriveApp.getFoldersByName(parentFolderName);
  if (!parentFolders.hasNext()) {
    throw new Error(`Dossier parent '${parentFolderName}' introuvable.`);
  }
  const parentFolder = parentFolders.next();
  
  // 2. Créer le dossier principal pour le client
  const clientFolder = parentFolder.createFolder(clientName);
  
  // 3. Créer les sous-dossiers
  subFolders.forEach(folderName => {
    clientFolder.createFolder(folderName);
  });
  
  console.log(`Arborescence créée pour le client ${clientName} à l'adresse : ${clientFolder.getUrl()}`);
}
</code></pre>
            </div>
        </div>

        <div class="section" id="conclusion">
            <h2>Conclusion et Prochaines Étapes</h2>
            <p>Vous avez maintenant configuré un environnement de développement extrêmement puissant, capable de traduire vos intentions en actions concrètes au sein de votre espace de travail Google. La véritable limite est votre imagination.</p>
            <h4>Pour aller plus loin :</h4>
            <ul>
                <li><strong>Explorez :</strong> N'hésitez pas à formuler des demandes plus complexes à Gemini. Essayez de combiner les services : "Prends les lignes de ce Sheet, pour chaque ligne, crée une slide dans cette présentation Google Slides, puis envoie-moi un email de confirmation."</li>
                <li><strong>Apprenez :</strong> Pour des cas très spécifiques, parcourez des ressources comme le dépôt <a href="https://github.com/tanaikech/taking-advantage-of-google-apps-script" target="_blank">"Taking Advantage of Google Apps Script"</a> pour découvrir des techniques avancées que vous pourrez ensuite demander à Gemini de mettre en œuvre.</li>
                <li><strong>Sécurisez :</strong> Gardez toujours à l'esprit les permissions que vous accordez. Le modèle OAuth2 est robuste, mais il est bon de vérifier régulièrement les applications ayant accès à votre compte.</li>
            </ul>
        </div>
    </div>

</body>
</html>
